"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _wrapNativeSuper(t){var e="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(t){if(null===t||!_isNativeFunction(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return _construct(t,arguments,_getPrototypeOf(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(r,t)})(t)}function isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _construct(t,e,r){return(_construct=isNativeReflectConstruct()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&_setPrototypeOf(o,r.prototype),o}).apply(null,arguments)}function _isNativeFunction(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Card=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).timerId=null,t}return _inherits(e,_wrapNativeSuper(HTMLElement)),_createClass(e,[{key:"connectedCallback",value:function(){var t=this,e=this.getAttribute("title"),r=this.getAttribute("desc"),n=this.getAttribute("date"),o=this.getAttribute("time"),a=this.getAllCardsFromStorage().length;this.innerHTML='\n      <div class="card">\n        <div class="card__title">'.concat(e,'</div>\n        <div class="card__desc">').concat(r,'</div>\n        <div class="card__deadline">\n          Осталось: \n          <span class="card__day"></span> Дня\n          <span class="card__hours"></span> часов\n          <span class="card__minutes"></span> минут\n          <span class="card__seconds"></span> секунд\n        </div>\n        <div class="card__delete" onclick="this.parentNode.parentNode.remove()" >\n          Удалить\n        </div>\n      </div>\n    '),this.setAttribute("index",a+1),this.addDataToStorage({index:a+1,title:e,desc:r,date:n,time:o}),this.renderDeadline(n,o),this.timerId=setInterval(function(){t.renderDeadline(n,o)},1e3)}},{key:"disconnectedCallback",value:function(){var t=parseInt(this.getAttribute("index"));this.deleteDataFromStorage(t),clearInterval(this.timerId)}},{key:"calculateDeadline",value:function(t,e){var r=Date.parse("".concat(t," ").concat(e))-Date.now(),n=Math.floor(r/1e3%60),o=Math.floor((r-n)/6e4%60),a=Math.floor((r-o)/36e5%24);return{days:Math.floor((r-a)/864e5),hours:a,minutes:o,seconds:n}}},{key:"renderDeadline",value:function(t,e){var r=this.querySelector(".card__day"),n=this.querySelector(".card__hours"),o=this.querySelector(".card__minutes"),a=this.querySelector(".card__seconds"),i=this.calculateDeadline(t,e),c=i.days,s=i.hours,u=i.minutes,l=i.seconds;r.innerHTML=c,n.innerHTML=s,o.innerHTML=u,a.innerHTML=l}},{key:"addDataToStorage",value:function(t){var e=this,r=this.getAllCardsFromStorage(),n=!1;r.forEach(function(r){e.deepEqual(r,t)&&(n=!0)}),n||localStorage.setItem("cards",JSON.stringify([].concat(_toConsumableArray(r),[t])))}},{key:"deepEqual",value:function(t,e){return JSON.stringify({title:t.title,desc:t.desc,date:t.date,time:t.time})===JSON.stringify({title:e.title,desc:e.desc,date:e.date,time:e.time})}},{key:"deleteDataFromStorage",value:function(t){var e=this.getAllCardsFromStorage(),r=e.findIndex(function(e){return e.index===t});localStorage.setItem("cards",JSON.stringify([].concat(_toConsumableArray(e.slice(0,r)),_toConsumableArray(e.slice(r+1)))))}},{key:"getAllCardsFromStorage",value:function(){return JSON.parse(localStorage.getItem("cards"))||[]}}]),e}(),Popup=function(){function t(e){var r=e.popup,n=e.overlay;_classCallCheck(this,t),this.popup=r,this.overlay=n}return _createClass(t,[{key:"show",value:function(){this._togglePopup(!0)}},{key:"hide",value:function(){this._togglePopup(!1)}},{key:"_togglePopup",value:function(t){t?(this.popup.classList.add("show"),this.overlay.classList.add("show"),this.popup.classList.remove("hide"),this.overlay.classList.remove("hide")):(this.popup.classList.add("hide"),this.overlay.classList.add("hide"),this.popup.classList.remove("show"),this.overlay.classList.remove("show"))}}]),t}();customElements.define("new-card",Card);var addBtn=document.querySelector(".add"),overlay=document.querySelector(".overlay"),popup=document.querySelector(".popup"),closeBtn=document.querySelector(".popup__close"),cards=document.querySelector(".deadlines"),titleInput=document.querySelector(".popup__title"),descInput=document.querySelector(".popup__desc"),dateInput=document.querySelector(".popup__date"),timeInput=document.querySelector(".popup__time"),addTask=document.querySelector(".popup__btn"),taskPopup=new Popup({popup:popup,overlay:overlay});function isEmptyField(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return e.some(function(t){return""===t.value})}function createCardWith(t){var e=document.createElement("new-card");e.setAttribute("title",t.title),e.setAttribute("desc",t.desc),e.setAttribute("date",t.date),e.setAttribute("time",t.time),cards.appendChild(e)}addBtn.addEventListener("click",function(){taskPopup.show()}),closeBtn.addEventListener("click",function(){taskPopup.hide()}),addTask.addEventListener("click",function(){isEmptyField(titleInput,descInput,dateInput,timeInput)||(createCardWith({title:titleInput.value,desc:descInput.value,date:dateInput.value,time:timeInput.value}),taskPopup.hide())});var allcards=JSON.parse(localStorage.getItem("cards"))||[];allcards.forEach(function(t){createCardWith({title:t.title,desc:t.desc,date:t.date,time:t.time})});
//# sourceMappingURL=main.js.map
